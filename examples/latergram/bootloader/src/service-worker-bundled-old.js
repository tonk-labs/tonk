const te="modulepreload",ne=function(n){return"/"+n},q={},v=function(e,t,r){let o=Promise.resolve();if(t&&t.length>0){document.getElementsByTagName("link");const s=document.querySelector("meta[property=csp-nonce]"),i=s?.nonce||s?.getAttribute("nonce");o=Promise.allSettled(t.map(w=>{if(w=ne(w),w in q)return;q[w]=!0;const g=w.endsWith(".css"),S=g?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${w}"]${S}`))return;const F=document.createElement("link");if(F.rel=g?"stylesheet":te,g||(F.as="script"),F.crossOrigin="",F.href=w,i&&F.setAttribute("nonce",i),document.head.appendChild(F),g)return new Promise((Z,ee)=>{F.addEventListener("load",Z),F.addEventListener("error",()=>ee(new Error(`Unable to preload CSS for ${w}`)))})}))}function _(s){const i=new Event("vite:preloadError",{cancelable:!0});if(i.payload=s,window.dispatchEvent(i),!i.defaultPrevented)throw s}return o.then(s=>{for(const i of s||[])i.status==="rejected"&&_(i.reason);return e().catch(_)})};var re=function(n,e,t,r,o){if(r==="m")throw new TypeError("Private method is not writable");if(r==="a"&&!o)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?n!==e||!o:!e.has(n))throw new TypeError("Cannot write private member to an object whose class did not declare it");return r==="a"?o.call(n,t):o?o.value=t:e.set(n,t),t},d=function(n,e,t,r){if(t==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?n!==e||!r:!e.has(n))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?r:t==="a"?r.call(n):r?r.value:e.get(n)},l;class M extends Error{constructor(e,t){super(e),this.code=t,this.name="TonkError"}}class oe extends M{constructor(e){super(e,"CONNECTION_ERROR"),this.name="ConnectionError"}}class p extends M{constructor(e){super(e,"FILESYSTEM_ERROR"),this.name="FileSystemError"}}class y{constructor(e){l.set(this,void 0),re(this,l,e,"f")}static async create(e,t){const r=t||await v(()=>Promise.resolve().then(()=>T),void 0);if(e?.peerId&&e?.storage){const{create_tonk_with_config:o}=r,_=await o(e.peerId,e.storage.type==="indexeddb");return new y(_)}else if(e?.peerId){const{create_tonk_with_peer_id:o}=r,_=await o(e.peerId);return new y(_)}else if(e?.storage){const{create_tonk_with_storage:o}=r,_=await o(e.storage.type==="indexeddb");return new y(_)}else{const{create_tonk:o}=r,_=await o();return new y(_)}}static async createWithPeerId(e,t){const{create_tonk_with_peer_id:r}=t||await v(()=>Promise.resolve().then(()=>T),void 0),o=await r(e);return new y(o)}static async fromBundle(e,t,r){const o=r||await v(()=>Promise.resolve().then(()=>T),void 0);if(t?.storage){const{create_tonk_from_bundle_with_storage:_}=o,s=await _(e,t.storage.type==="indexeddb");return new y(s)}else{const{create_tonk_from_bundle:_}=o,s=await _(e);return new y(s)}}static async fromBytes(e,t,r){const o=r||await v(()=>Promise.resolve().then(()=>T),void 0);if(t?.storage){const{create_tonk_from_bytes_with_storage:_}=o,s=await _(e,t.storage.type==="indexeddb");return new y(s)}else{const{create_tonk_from_bytes:_}=o,s=await _(e);return new y(s)}}getPeerId(){return d(this,l,"f").getPeerId()}async connectWebsocket(e){try{await d(this,l,"f").connectWebsocket(e)}catch(t){throw new oe(`Failed to connect to ${e}: ${t}`)}}async toBytes(){try{return await d(this,l,"f").toBytes()}catch(e){throw new M(`Failed to serialize to bundle data: ${e}`)}}async createFile(e,t){try{await d(this,l,"f").createFile(e,t)}catch(r){throw new p(`Failed to create file at ${e}: ${r}`)}}async createFileWithBytes(e,t,r){try{await d(this,l,"f").createFileWithBytes(e,t,r)}catch(o){throw new p(`Failed to create file at ${e}: ${o}`)}}async readFile(e){try{const t=await d(this,l,"f").readFile(e);if(t===null)throw new p(`File not found: ${e}`);return t}catch(t){throw t instanceof p?t:new p(`Failed to read file at ${e}: ${t}`)}}async updateFile(e,t){try{return await d(this,l,"f").updateFile(e,t)}catch(r){throw new p(`Failed to update file at ${e}: ${r}`)}}async updateFileWithBytes(e,t,r){try{return await d(this,l,"f").updateFileWithBytes(e,t,r)}catch(o){throw new p(`Failed to update file at ${e}: ${o}`)}}async deleteFile(e){try{return await d(this,l,"f").deleteFile(e)}catch(t){throw new p(`Failed to delete file at ${e}: ${t}`)}}async createDirectory(e){try{await d(this,l,"f").createDirectory(e)}catch(t){throw new p(`Failed to create directory at ${e}: ${t}`)}}async listDirectory(e){try{return(await d(this,l,"f").listDirectory(e)).map(r=>({name:r.name,type:r.type}))}catch(t){throw new p(`Failed to list directory at ${e}: ${t}`)}}async exists(e){try{return await d(this,l,"f").exists(e)}catch(t){throw new p(`Failed to check existence of ${e}: ${t}`)}}async getMetadata(e){try{const t=await d(this,l,"f").getMetadata(e);return t===null?null:{nodeType:t.node_type,createdAt:new Date(t.created_at*1e3),modifiedAt:new Date(t.modified_at*1e3)}}catch(t){throw new p(`Failed to get metadata for ${e}: ${t}`)}}async watchFile(e,t){try{const r=await d(this,l,"f").watchDocument(e,t);return r===null?null:r}catch(r){throw new p(`Failed to watch file at path ${e}: ${r}`)}}async watchDirectory(e,t){try{const r=await d(this,l,"f").watchDirectory(e,t);return r===null?null:r}catch(r){throw new p(`Failed to watch directory at path ${e}: ${r}`)}}free(){d(this,l,"f").free()}}l=new WeakMap;let c,u=0,B=null;function R(){return(B===null||B.byteLength===0)&&(B=new Uint8Array(c.memory.buffer)),B}const D=typeof TextEncoder<"u"?new TextEncoder("utf-8"):{encode:()=>{throw Error("TextEncoder not available")}},ce=typeof D.encodeInto=="function"?function(n,e){return D.encodeInto(n,e)}:function(n,e){const t=D.encode(n);return e.set(t),{read:n.length,written:t.length}};function b(n,e,t){if(t===void 0){const i=D.encode(n),w=e(i.length,1)>>>0;return R().subarray(w,w+i.length).set(i),u=i.length,w}let r=n.length,o=e(r,1)>>>0;const _=R();let s=0;for(;s<r;s++){const i=n.charCodeAt(s);if(i>127)break;_[o+s]=i}if(s!==r){s!==0&&(n=n.slice(s)),o=t(o,r,r=s+n.length*3,1)>>>0;const i=R().subarray(o+s,o+r),w=ce(n,i);s+=w.written,o=t(o,r,s,1)>>>0}return u=s,o}let E=null;function f(){return(E===null||E.buffer.detached===!0||E.buffer.detached===void 0&&E.buffer!==c.memory.buffer)&&(E=new DataView(c.memory.buffer)),E}function k(n){const e=c.__externref_table_alloc();return c.__wbindgen_export_4.set(e,n),e}function a(n,e){try{return n.apply(this,e)}catch(t){const r=k(t);c.__wbindgen_exn_store(r)}}const Y=typeof TextDecoder<"u"?new TextDecoder("utf-8",{ignoreBOM:!0,fatal:!0}):{decode:()=>{throw Error("TextDecoder not available")}};typeof TextDecoder<"u"&&Y.decode();function h(n,e){return n=n>>>0,Y.decode(R().subarray(n,n+e))}function m(n){return n==null}function U(n,e){return n=n>>>0,R().subarray(n/1,n/1+e)}const z=typeof FinalizationRegistry>"u"?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry(n=>{c.__wbindgen_export_6.get(n.dtor)(n.a,n.b)});function x(n,e,t,r){const o={a:n,b:e,cnt:1,dtor:t},_=(...s)=>{o.cnt++;const i=o.a;o.a=0;try{return r(i,o.b,...s)}finally{--o.cnt===0?(c.__wbindgen_export_6.get(o.dtor)(i,o.b),z.unregister(o)):o.a=i}};return _.original=o,z.register(_,o,o),_}function j(n){const e=typeof n;if(e=="number"||e=="boolean"||n==null)return`${n}`;if(e=="string")return`"${n}"`;if(e=="symbol"){const o=n.description;return o==null?"Symbol":`Symbol(${o})`}if(e=="function"){const o=n.name;return typeof o=="string"&&o.length>0?`Function(${o})`:"Function"}if(Array.isArray(n)){const o=n.length;let _="[";o>0&&(_+=j(n[0]));for(let s=1;s<o;s++)_+=", "+j(n[s]);return _+="]",_}const t=/\[object ([^\]]+)\]/.exec(toString.call(n));let r;if(t&&t.length>1)r=t[1];else return toString.call(n);if(r=="Object")try{return"Object("+JSON.stringify(n)+")"}catch{return"Object"}return n instanceof Error?`${n.name}: ${n.message}
${n.stack}`:r}function C(n){const e=c.__wbindgen_export_4.get(n);return c.__externref_table_dealloc(n),e}function L(n,e){if(!(n instanceof e))throw new Error(`expected instance of ${e.name}`)}function N(n,e){const t=e(n.length*1,1)>>>0;return R().set(n,t/1),u=n.length,t}function _e(n){return L(n,I),c.create_tonk_from_bundle(n.__wbg_ptr)}function se(n){return c.create_tonk_from_bytes(n)}function ie(n){const e=c.create_bundle_from_bytes(n);if(e[2])throw C(e[1]);return I.__wrap(e[0])}function ae(){return c.create_tonk()}function ue(n,e){return L(n,I),c.create_tonk_from_bundle_with_storage(n.__wbg_ptr,e)}function we(n,e){return c.create_tonk_from_bytes_with_storage(n,e)}function be(n,e){const t=b(n,c.__wbindgen_malloc,c.__wbindgen_realloc),r=u;return c.create_tonk_with_config(t,r,e)}function fe(n){return c.create_tonk_with_storage(n)}function le(){c.init()}function ge(n){const e=b(n,c.__wbindgen_malloc,c.__wbindgen_realloc),t=u;return c.create_tonk_with_peer_id(e,t)}function de(n){c.set_time_provider(n)}function O(n,e,t){c.closure246_externref_shim(n,e,t)}function me(n,e,t){const r=c.closure250_externref_shim_multivalue_shim(n,e,t);if(r[1])throw C(r[0])}function pe(n,e,t){c.closure754_externref_shim(n,e,t)}function he(n,e){c._dyn_core__ops__function__FnMut_____Output___R_as_wasm_bindgen__closure__WasmClosure___describe__invoke__h4939de6411d337f8(n,e)}function ye(n,e,t){c.closure771_externref_shim(n,e,t)}function ke(n,e,t,r){c.closure1070_externref_shim(n,e,t,r)}const Fe=["blob","arraybuffer"],Ie=["pending","done"],xe=["readonly","readwrite","versionchange","readwriteflush","cleanup"],V=typeof FinalizationRegistry>"u"?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry(n=>c.__wbg_wasmbundle_free(n>>>0,1));class I{static __wrap(e){e=e>>>0;const t=Object.create(I.prototype);return t.__wbg_ptr=e,V.register(t,t.__wbg_ptr,t),t}__destroy_into_raw(){const e=this.__wbg_ptr;return this.__wbg_ptr=0,V.unregister(this),e}free(){const e=this.__destroy_into_raw();c.__wbg_wasmbundle_free(e,0)}static fromBytes(e){const t=c.wasmbundle_fromBytes(e);if(t[2])throw C(t[1]);return I.__wrap(t[0])}getPrefix(e){const t=b(e,c.__wbindgen_malloc,c.__wbindgen_realloc),r=u;return c.wasmbundle_getPrefix(this.__wbg_ptr,t,r)}getRootId(){return c.wasmbundle_getRootId(this.__wbg_ptr)}getManifest(){return c.wasmbundle_getManifest(this.__wbg_ptr)}get(e){const t=b(e,c.__wbindgen_malloc,c.__wbindgen_realloc),r=u;return c.wasmbundle_get(this.__wbg_ptr,t,r)}toBytes(){return c.wasmbundle_toBytes(this.__wbg_ptr)}listKeys(){return c.wasmbundle_listKeys(this.__wbg_ptr)}}const G=typeof FinalizationRegistry>"u"?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry(n=>c.__wbg_wasmdocumentwatcher_free(n>>>0,1));class P{static __wrap(e){e=e>>>0;const t=Object.create(P.prototype);return t.__wbg_ptr=e,G.register(t,t.__wbg_ptr,t),t}__destroy_into_raw(){const e=this.__wbg_ptr;return this.__wbg_ptr=0,G.unregister(this),e}free(){const e=this.__destroy_into_raw();c.__wbg_wasmdocumentwatcher_free(e,0)}documentId(){let e,t;try{const r=c.wasmdocumentwatcher_documentId(this.__wbg_ptr);return e=r[0],t=r[1],h(r[0],r[1])}finally{c.__wbindgen_free(e,t,1)}}stop(){return c.wasmdocumentwatcher_stop(this.__wbg_ptr)}}const K=typeof FinalizationRegistry>"u"?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry(n=>c.__wbg_wasmtonkcore_free(n>>>0,1));class A{static __wrap(e){e=e>>>0;const t=Object.create(A.prototype);return t.__wbg_ptr=e,K.register(t,t.__wbg_ptr,t),t}__destroy_into_raw(){const e=this.__wbg_ptr;return this.__wbg_ptr=0,K.unregister(this),e}free(){const e=this.__destroy_into_raw();c.__wbg_wasmtonkcore_free(e,0)}static fromBytes(e){return c.wasmtonkcore_fromBytes(e)}createFile(e,t){const r=b(e,c.__wbindgen_malloc,c.__wbindgen_realloc),o=u;return c.wasmtonkcore_createFile(this.__wbg_ptr,r,o,t)}deleteFile(e){const t=b(e,c.__wbindgen_malloc,c.__wbindgen_realloc),r=u;return c.wasmtonkcore_deleteFile(this.__wbg_ptr,t,r)}static fromBundle(e){return L(e,I),c.wasmtonkcore_fromBundle(e.__wbg_ptr)}getPeerId(){return c.wasmtonkcore_getPeerId(this.__wbg_ptr)}updateFile(e,t){const r=b(e,c.__wbindgen_malloc,c.__wbindgen_realloc),o=u;return c.wasmtonkcore_updateFile(this.__wbg_ptr,r,o,t)}getMetadata(e){const t=b(e,c.__wbindgen_malloc,c.__wbindgen_realloc),r=u;return c.wasmtonkcore_getMetadata(this.__wbg_ptr,t,r)}static withPeerId(e){const t=b(e,c.__wbindgen_malloc,c.__wbindgen_realloc),r=u;return c.wasmtonkcore_withPeerId(t,r)}listDirectory(e){const t=b(e,c.__wbindgen_malloc,c.__wbindgen_realloc),r=u;return c.wasmtonkcore_listDirectory(this.__wbg_ptr,t,r)}watchDocument(e,t){const r=b(e,c.__wbindgen_malloc,c.__wbindgen_realloc),o=u;return c.wasmtonkcore_watchDocument(this.__wbg_ptr,r,o,t)}watchDirectory(e,t){const r=b(e,c.__wbindgen_malloc,c.__wbindgen_realloc),o=u;return c.wasmtonkcore_watchDirectory(this.__wbg_ptr,r,o,t)}createDirectory(e){const t=b(e,c.__wbindgen_malloc,c.__wbindgen_realloc),r=u;return c.wasmtonkcore_createDirectory(this.__wbg_ptr,t,r)}connectWebsocket(e){const t=b(e,c.__wbindgen_malloc,c.__wbindgen_realloc),r=u;return c.wasmtonkcore_connectWebsocket(this.__wbg_ptr,t,r)}createFileWithBytes(e,t,r){const o=b(e,c.__wbindgen_malloc,c.__wbindgen_realloc),_=u,s=N(r,c.__wbindgen_malloc),i=u;return c.wasmtonkcore_createFileWithBytes(this.__wbg_ptr,o,_,t,s,i)}updateFileWithBytes(e,t,r){const o=b(e,c.__wbindgen_malloc,c.__wbindgen_realloc),_=u,s=N(r,c.__wbindgen_malloc),i=u;return c.wasmtonkcore_updateFileWithBytes(this.__wbg_ptr,o,_,t,s,i)}constructor(){return c.wasmtonkcore_new()}exists(e){const t=b(e,c.__wbindgen_malloc,c.__wbindgen_realloc),r=u;return c.wasmtonkcore_exists(this.__wbg_ptr,t,r)}toBytes(){return c.wasmtonkcore_toBytes(this.__wbg_ptr)}readFile(e){const t=b(e,c.__wbindgen_malloc,c.__wbindgen_realloc),r=u;return c.wasmtonkcore_readFile(this.__wbg_ptr,t,r)}}async function Ee(n,e){if(typeof Response=="function"&&n instanceof Response){if(typeof WebAssembly.instantiateStreaming=="function")try{return await WebAssembly.instantiateStreaming(n,e)}catch(r){if(n.headers.get("Content-Type")!="application/wasm")console.warn("`WebAssembly.instantiateStreaming` failed because your server does not serve Wasm with `application/wasm` MIME type. Falling back to `WebAssembly.instantiate` which is slower. Original error:\n",r);else throw r}const t=await n.arrayBuffer();return await WebAssembly.instantiate(t,e)}else{const t=await WebAssembly.instantiate(n,e);return t instanceof WebAssembly.Instance?{instance:t,module:n}:t}}function Q(){const n={};return n.wbg={},n.wbg.__wbg_String_8f0eb39a4a4c2f66=function(e,t){const r=String(t),o=b(r,c.__wbindgen_malloc,c.__wbindgen_realloc),_=u;f().setInt32(e+4*1,_,!0),f().setInt32(e+4*0,o,!0)},n.wbg.__wbg_Window_41559019033ede94=function(e){return e.Window},n.wbg.__wbg_WorkerGlobalScope_d324bffbeaef9f3a=function(e){return e.WorkerGlobalScope},n.wbg.__wbg_abort_99fc644e2c79c9fb=function(){return a(function(e){e.abort()},arguments)},n.wbg.__wbg_bound_f2afc3766d4545cf=function(){return a(function(e,t,r,o){return IDBKeyRange.bound(e,t,r!==0,o!==0)},arguments)},n.wbg.__wbg_buffer_09165b52af8c5237=function(e){return e.buffer},n.wbg.__wbg_buffer_609cc3eee51ed158=function(e){return e.buffer},n.wbg.__wbg_call_672a4d21634d4a24=function(){return a(function(e,t){return e.call(t)},arguments)},n.wbg.__wbg_call_7cccdd69e0791ae2=function(){return a(function(e,t,r){return e.call(t,r)},arguments)},n.wbg.__wbg_close_2893b7d056a0627d=function(){return a(function(e){e.close()},arguments)},n.wbg.__wbg_commit_a54edce65f3858f2=function(){return a(function(e){e.commit()},arguments)},n.wbg.__wbg_continue_c46c11d3dbe1b030=function(){return a(function(e){e.continue()},arguments)},n.wbg.__wbg_createObjectStore_e566459f7161f82f=function(){return a(function(e,t,r){return e.createObjectStore(h(t,r))},arguments)},n.wbg.__wbg_data_432d9c3df2630942=function(e){return e.data},n.wbg.__wbg_delete_200677093b4cf756=function(){return a(function(e,t){return e.delete(t)},arguments)},n.wbg.__wbg_done_769e5ede4b31c67b=function(e){return e.done},n.wbg.__wbg_entries_3265d4158b33e5dc=function(e){return Object.entries(e)},n.wbg.__wbg_error_31d7961b8e0d3f6c=function(e,t){console.error(h(e,t))},n.wbg.__wbg_error_7534b8e9a36f1ab4=function(e,t){let r,o;try{r=e,o=t,console.error(h(e,t))}finally{c.__wbindgen_free(r,o,1)}},n.wbg.__wbg_error_ff4ddaabdfc5dbb3=function(){return a(function(e){const t=e.error;return m(t)?0:k(t)},arguments)},n.wbg.__wbg_getRandomValues_38a1ff1ea09f6cc7=function(){return a(function(e,t){globalThis.crypto.getRandomValues(U(e,t))},arguments)},n.wbg.__wbg_getRandomValues_3c9c0d586e575a16=function(){return a(function(e,t){globalThis.crypto.getRandomValues(U(e,t))},arguments)},n.wbg.__wbg_getTime_46267b1c24877e30=function(e){return e.getTime()},n.wbg.__wbg_get_67b2ba62fc30de12=function(){return a(function(e,t){return Reflect.get(e,t)},arguments)},n.wbg.__wbg_get_8da03f81f6a1111e=function(){return a(function(e,t){return e.get(t)},arguments)},n.wbg.__wbg_get_b9b93047fe3cf45b=function(e,t){return e[t>>>0]},n.wbg.__wbg_global_f5c2926e57ba457f=function(e){return e.global},n.wbg.__wbg_indexedDB_54f01430b1e194e8=function(){return a(function(e){const t=e.indexedDB;return m(t)?0:k(t)},arguments)},n.wbg.__wbg_indexedDB_b1f49280282046f8=function(){return a(function(e){const t=e.indexedDB;return m(t)?0:k(t)},arguments)},n.wbg.__wbg_indexedDB_f6b47b0dc333fd2f=function(){return a(function(e){const t=e.indexedDB;return m(t)?0:k(t)},arguments)},n.wbg.__wbg_instanceof_ArrayBuffer_e14585432e3737fc=function(e){let t;try{t=e instanceof ArrayBuffer}catch{t=!1}return t},n.wbg.__wbg_instanceof_CursorSys_4b6a8aba0e823e75=function(e){let t;try{t=e instanceof IDBCursorWithValue}catch{t=!1}return t},n.wbg.__wbg_instanceof_DomException_ed1ccb7aaf39034c=function(e){let t;try{t=e instanceof DOMException}catch{t=!1}return t},n.wbg.__wbg_instanceof_Error_4d54113b22d20306=function(e){let t;try{t=e instanceof Error}catch{t=!1}return t},n.wbg.__wbg_instanceof_IdbCursor_4f02b0cddf69c141=function(e){let t;try{t=e instanceof IDBCursor}catch{t=!1}return t},n.wbg.__wbg_instanceof_IdbDatabase_a3ef009ca00059f9=function(e){let t;try{t=e instanceof IDBDatabase}catch{t=!1}return t},n.wbg.__wbg_instanceof_IdbRequest_4813c3f207666aa4=function(e){let t;try{t=e instanceof IDBRequest}catch{t=!1}return t},n.wbg.__wbg_instanceof_Map_f3469ce2244d2430=function(e){let t;try{t=e instanceof Map}catch{t=!1}return t},n.wbg.__wbg_instanceof_Uint8Array_17156bcf118086a9=function(e){let t;try{t=e instanceof Uint8Array}catch{t=!1}return t},n.wbg.__wbg_isArray_a1eab7e0d067391b=function(e){return Array.isArray(e)},n.wbg.__wbg_isSafeInteger_343e2beeeece1bb0=function(e){return Number.isSafeInteger(e)},n.wbg.__wbg_item_c3c26b4103ad5aaf=function(e,t,r){const o=t.item(r>>>0);var _=m(o)?0:b(o,c.__wbindgen_malloc,c.__wbindgen_realloc),s=u;f().setInt32(e+4*1,s,!0),f().setInt32(e+4*0,_,!0)},n.wbg.__wbg_iterator_9a24c88df860dc65=function(){return Symbol.iterator},n.wbg.__wbg_key_29fefecef430db96=function(){return a(function(e){return e.key},arguments)},n.wbg.__wbg_length_a446193dc22c12f8=function(e){return e.length},n.wbg.__wbg_length_e2d2a49132c1b256=function(e){return e.length},n.wbg.__wbg_log_2f4a53bbb94ad21b=function(e,t){console.log(h(e,t))},n.wbg.__wbg_lowerBound_1872d19f5bcf83c6=function(){return a(function(e,t){return IDBKeyRange.lowerBound(e,t!==0)},arguments)},n.wbg.__wbg_message_5c5d919204d42400=function(e,t){const r=t.message,o=b(r,c.__wbindgen_malloc,c.__wbindgen_realloc),_=u;f().setInt32(e+4*1,_,!0),f().setInt32(e+4*0,o,!0)},n.wbg.__wbg_message_97a2af9b89d693a3=function(e){return e.message},n.wbg.__wbg_message_d1685a448ba00178=function(e,t){const r=t.message,o=b(r,c.__wbindgen_malloc,c.__wbindgen_realloc),_=u;f().setInt32(e+4*1,_,!0),f().setInt32(e+4*0,o,!0)},n.wbg.__wbg_name_f2d27098bfd843e7=function(e,t){const r=t.name,o=b(r,c.__wbindgen_malloc,c.__wbindgen_realloc),_=u;f().setInt32(e+4*1,_,!0),f().setInt32(e+4*0,o,!0)},n.wbg.__wbg_new0_f788a2397c7ca929=function(){return new Date},n.wbg.__wbg_new_23a2665fac83c611=function(e,t){try{var r={a:e,b:t},o=(s,i)=>{const w=r.a;r.a=0;try{return ke(w,r.b,s,i)}finally{r.a=w}};return new Promise(o)}finally{r.a=r.b=0}},n.wbg.__wbg_new_405e22f390576ce2=function(){return new Object},n.wbg.__wbg_new_5e0be73521bc8c17=function(){return new Map},n.wbg.__wbg_new_78feb108b6472713=function(){return new Array},n.wbg.__wbg_new_8a6f238a6ece86ea=function(){return new Error},n.wbg.__wbg_new_92c54fc74574ef55=function(){return a(function(e,t){return new WebSocket(h(e,t))},arguments)},n.wbg.__wbg_new_a12002a7f91c75be=function(e){return new Uint8Array(e)},n.wbg.__wbg_new_c68d7209be747379=function(e,t){return new Error(h(e,t))},n.wbg.__wbg_newnoargs_105ed471475aaf50=function(e,t){return new Function(h(e,t))},n.wbg.__wbg_newwithbyteoffsetandlength_d97e637ebe145a9a=function(e,t,r){return new Uint8Array(e,t>>>0,r>>>0)},n.wbg.__wbg_newwithlength_a381634e90c276d4=function(e){return new Uint8Array(e>>>0)},n.wbg.__wbg_next_25feadfc0913fea9=function(e){return e.next},n.wbg.__wbg_next_6574e1a8a62d1055=function(){return a(function(e){return e.next()},arguments)},n.wbg.__wbg_now_807e54c39636c349=function(){return Date.now()},n.wbg.__wbg_objectStoreNames_9bb1ab04a7012aaf=function(e){return e.objectStoreNames},n.wbg.__wbg_objectStore_21878d46d25b64b6=function(){return a(function(e,t,r){return e.objectStore(h(t,r))},arguments)},n.wbg.__wbg_openCursor_238e247d18bde2cd=function(){return a(function(e){return e.openCursor()},arguments)},n.wbg.__wbg_open_e0c0b2993eb596e1=function(){return a(function(e,t,r,o){return e.open(h(t,r),o>>>0)},arguments)},n.wbg.__wbg_push_737cfc8c1432c2c6=function(e,t){return e.push(t)},n.wbg.__wbg_put_066faa31a6a88f5b=function(){return a(function(e,t,r){return e.put(t,r)},arguments)},n.wbg.__wbg_queueMicrotask_97d92b4fcc8a61c5=function(e){queueMicrotask(e)},n.wbg.__wbg_queueMicrotask_d3219def82552485=function(e){return e.queueMicrotask},n.wbg.__wbg_readyState_4013cfdf4f22afb0=function(e){const t=e.readyState;return(Ie.indexOf(t)+1||3)-1},n.wbg.__wbg_request_5079471e06223120=function(e){return e.request},n.wbg.__wbg_request_fada8c23b78b3a02=function(e){return e.request},n.wbg.__wbg_resolve_4851785c9c5f573d=function(e){return Promise.resolve(e)},n.wbg.__wbg_result_f29afabdf2c05826=function(){return a(function(e){return e.result},arguments)},n.wbg.__wbg_send_7c4769e24cf1d784=function(){return a(function(e,t){e.send(t)},arguments)},n.wbg.__wbg_set_37837023f3d740e8=function(e,t,r){e[t>>>0]=r},n.wbg.__wbg_set_3f1d0b984ed272ed=function(e,t,r){e[t]=r},n.wbg.__wbg_set_65595bdd868b3009=function(e,t,r){e.set(t,r>>>0)},n.wbg.__wbg_set_8fc6bf8a5b1071d1=function(e,t,r){return e.set(t,r)},n.wbg.__wbg_set_bb8cecf6a62b9f46=function(){return a(function(e,t,r){return Reflect.set(e,t,r)},arguments)},n.wbg.__wbg_setbinaryType_92fa1ffd873b327c=function(e,t){e.binaryType=Fe[t]},n.wbg.__wbg_setonabort_3bf4db6614fa98e9=function(e,t){e.onabort=t},n.wbg.__wbg_setonclose_14fc475a49d488fc=function(e,t){e.onclose=t},n.wbg.__wbg_setoncomplete_4d19df0dadb7c4d4=function(e,t){e.oncomplete=t},n.wbg.__wbg_setonerror_8639efe354b947cd=function(e,t){e.onerror=t},n.wbg.__wbg_setonerror_b0d9d723b8fddbbb=function(e,t){e.onerror=t},n.wbg.__wbg_setonerror_d7e3056cc6e56085=function(e,t){e.onerror=t},n.wbg.__wbg_setonmessage_6eccab530a8fb4c7=function(e,t){e.onmessage=t},n.wbg.__wbg_setonopen_2da654e1f39745d5=function(e,t){e.onopen=t},n.wbg.__wbg_setonsuccess_afa464ee777a396d=function(e,t){e.onsuccess=t},n.wbg.__wbg_setonupgradeneeded_fcf7ce4f2eb0cb5f=function(e,t){e.onupgradeneeded=t},n.wbg.__wbg_stack_0ed75d68575b0f3c=function(e,t){const r=t.stack,o=b(r,c.__wbindgen_malloc,c.__wbindgen_realloc),_=u;f().setInt32(e+4*1,_,!0),f().setInt32(e+4*0,o,!0)},n.wbg.__wbg_static_accessor_GLOBAL_88a902d13a557d07=function(){const e=typeof globalThis>"u"?null:globalThis;return m(e)?0:k(e)},n.wbg.__wbg_static_accessor_GLOBAL_THIS_56578be7e9f832b0=function(){const e=typeof globalThis>"u"?null:globalThis;return m(e)?0:k(e)},n.wbg.__wbg_static_accessor_SELF_37c5d418e4bf5819=function(){const e=typeof self>"u"?null:self;return m(e)?0:k(e)},n.wbg.__wbg_static_accessor_WINDOW_5de37043a91a9c40=function(){const e=typeof window>"u"?null:window;return m(e)?0:k(e)},n.wbg.__wbg_target_0a62d9d79a2a1ede=function(e){const t=e.target;return m(t)?0:k(t)},n.wbg.__wbg_then_44b73946d2fb3e7d=function(e,t){return e.then(t)},n.wbg.__wbg_then_48b406749878a531=function(e,t,r){return e.then(t,r)},n.wbg.__wbg_toString_5285597960676b7b=function(e){return e.toString()},n.wbg.__wbg_transaction_7d452475ef3c3c33=function(e){return e.transaction},n.wbg.__wbg_transaction_babc423936946a37=function(){return a(function(e,t,r,o){return e.transaction(h(t,r),xe[o])},arguments)},n.wbg.__wbg_upperBound_76a00814e81f6891=function(){return a(function(e,t){return IDBKeyRange.upperBound(e,t!==0)},arguments)},n.wbg.__wbg_value_68c4e9a54bb7fd5e=function(){return a(function(e){return e.value},arguments)},n.wbg.__wbg_value_cd1ffa7b1ab794f1=function(e){return e.value},n.wbg.__wbg_wasmdocumentwatcher_new=function(e){return P.__wrap(e)},n.wbg.__wbg_wasmtonkcore_new=function(e){return A.__wrap(e)},n.wbg.__wbindgen_bigint_from_i64=function(e){return e},n.wbg.__wbindgen_bigint_from_u64=function(e){return BigInt.asUintN(64,e)},n.wbg.__wbindgen_bigint_get_as_i64=function(e,t){const r=t,o=typeof r=="bigint"?r:void 0;f().setBigInt64(e+8*1,m(o)?BigInt(0):o,!0),f().setInt32(e+4*0,!m(o),!0)},n.wbg.__wbindgen_boolean_get=function(e){const t=e;return typeof t=="boolean"?t?1:0:2},n.wbg.__wbindgen_cb_drop=function(e){const t=e.original;return t.cnt--==1?(t.a=0,!0):!1},n.wbg.__wbindgen_closure_wrapper1823=function(e,t,r){return x(e,t,755,pe)},n.wbg.__wbindgen_closure_wrapper1825=function(e,t,r){return x(e,t,755,he)},n.wbg.__wbindgen_closure_wrapper1885=function(e,t,r){return x(e,t,772,ye)},n.wbg.__wbindgen_closure_wrapper636=function(e,t,r){return x(e,t,247,O)},n.wbg.__wbindgen_closure_wrapper638=function(e,t,r){return x(e,t,247,me)},n.wbg.__wbindgen_closure_wrapper640=function(e,t,r){return x(e,t,247,O)},n.wbg.__wbindgen_closure_wrapper642=function(e,t,r){return x(e,t,247,O)},n.wbg.__wbindgen_debug_string=function(e,t){const r=j(t),o=b(r,c.__wbindgen_malloc,c.__wbindgen_realloc),_=u;f().setInt32(e+4*1,_,!0),f().setInt32(e+4*0,o,!0)},n.wbg.__wbindgen_error_new=function(e,t){return new Error(h(e,t))},n.wbg.__wbindgen_in=function(e,t){return e in t},n.wbg.__wbindgen_init_externref_table=function(){const e=c.__wbindgen_export_4,t=e.grow(4);e.set(0,void 0),e.set(t+0,void 0),e.set(t+1,null),e.set(t+2,!0),e.set(t+3,!1)},n.wbg.__wbindgen_is_bigint=function(e){return typeof e=="bigint"},n.wbg.__wbindgen_is_function=function(e){return typeof e=="function"},n.wbg.__wbindgen_is_null=function(e){return e===null},n.wbg.__wbindgen_is_object=function(e){const t=e;return typeof t=="object"&&t!==null},n.wbg.__wbindgen_is_string=function(e){return typeof e=="string"},n.wbg.__wbindgen_is_undefined=function(e){return e===void 0},n.wbg.__wbindgen_jsval_eq=function(e,t){return e===t},n.wbg.__wbindgen_jsval_loose_eq=function(e,t){return e==t},n.wbg.__wbindgen_memory=function(){return c.memory},n.wbg.__wbindgen_number_get=function(e,t){const r=t,o=typeof r=="number"?r:void 0;f().setFloat64(e+8*1,m(o)?0:o,!0),f().setInt32(e+4*0,!m(o),!0)},n.wbg.__wbindgen_number_new=function(e){return e},n.wbg.__wbindgen_string_get=function(e,t){const r=t,o=typeof r=="string"?r:void 0;var _=m(o)?0:b(o,c.__wbindgen_malloc,c.__wbindgen_realloc),s=u;f().setInt32(e+4*1,s,!0),f().setInt32(e+4*0,_,!0)},n.wbg.__wbindgen_string_new=function(e,t){return h(e,t)},n.wbg.__wbindgen_throw=function(e,t){throw new Error(h(e,t))},n}function X(n,e){return c=n.exports,$.__wbindgen_wasm_module=e,E=null,B=null,c.__wbindgen_start(),c}function Re(n){if(c!==void 0)return c;typeof n<"u"&&(Object.getPrototypeOf(n)===Object.prototype?{module:n}=n:console.warn("using deprecated parameters for `initSync()`; pass a single object instead"));const e=Q();n instanceof WebAssembly.Module||(n=new WebAssembly.Module(n));const t=new WebAssembly.Instance(n,e);return X(t,n)}async function $(n){if(c!==void 0)return c;typeof n<"u"&&(Object.getPrototypeOf(n)===Object.prototype?{module_or_path:n}=n:console.warn("using deprecated parameters for the initialization function; pass a single object instead")),typeof n>"u"&&(n=new URL("/assets/tonk_core_bg-BjovLCWw.wasm",import.meta.url));const e=Q();(typeof n=="string"||typeof Request=="function"&&n instanceof Request||typeof URL=="function"&&n instanceof URL)&&(n=fetch(n));const{instance:t,module:r}=await Ee(await n,e);return X(t,r)}const T=Object.freeze(Object.defineProperty({__proto__:null,WasmBundle:I,WasmDocumentWatcher:P,WasmTonkCore:A,create_bundle_from_bytes:ie,create_tonk:ae,create_tonk_from_bundle:_e,create_tonk_from_bundle_with_storage:ue,create_tonk_from_bytes:se,create_tonk_from_bytes_with_storage:we,create_tonk_with_config:be,create_tonk_with_peer_id:ge,create_tonk_with_storage:fe,default:$,init:le,initSync:Re,set_time_provider:de},Symbol.toStringTag,{value:"Module"}));let H=!1,W=null;async function Se(n){if(!H)return W||(W=(async()=>{try{n?.wasmPath?await $(n.wasmPath):await $(),H=!0}catch(e){throw W=null,e}})(),W)}const We="v6";async function Be(){await Se({wasmPath:"http://localhost:8081/tonk_core_bg.wasm"});const e=await(await fetch("http://localhost:8081/.manifest.tonk")).arrayBuffer(),t=await y.fromBytes(new Uint8Array(e));return await t.connectWebsocket("ws://localhost:8081"),self.tonk=t,t}console.log("Before registration");const ve=Be();ve.then(n=>{self.tonk=n,console.log("Tonk core service worker initialized")});async function Te(){const n=[We],t=(await caches.keys()).map(r=>{if(!n.includes(r))return caches.delete(r)});await Promise.all(t)}self.addEventListener("install",n=>{console.log("Installing SW"),self.skipWaiting()});self.addEventListener("activate",async n=>{console.log("Activating service worker."),await Te(),clients.claim()});const J=async n=>{if(n.mimeType)return new Response(n.content,{headers:{"Content-Type":n.mimeType}});if(typeof n=="string")try{const e=atob(n);let t="text/plain";return e.trim().startsWith("<!DOCTYPE html")||e.trim().startsWith("<html")?t="text/html":e.trim().startsWith("{")||e.trim().startsWith("[")?t="application/json":e.includes("function")||e.includes("const ")||e.includes("import ")?t="application/javascript":(e.includes("body {")||e.includes("@media"))&&(t="text/css"),new Response(e,{headers:{"Content-Type":t}})}catch{return new Response(n,{headers:{"Content-Type":"text/plain"}})}return new Response(JSON.stringify(n),{headers:{"Content-Type":"application/json"}})};self.addEventListener("fetch",async n=>{const e=new URL(n.request.url);console.log("response requested"),e.origin===location.origin&&n.respondWith((async()=>{let t=e.pathname;console.log("Service worker handling:",t);const r=n.request.referrer;let o=null;if(r){const g=new URL(r).pathname.match(/^\/([^\/]+)\//);g&&(o=g[1])}if(t==="/"){t="/index.html";const i=await caches.match(n.request);return i||fetch(n.request)}const _=t.match(/^\/([^\/]+)(?:\/(.*))?$/);if(_&&!t.startsWith("/assets/")&&!t.includes(".js")&&!t.includes(".css")&&!t.includes(".wasm")){const[,i,w=""]=_;let g=`/app/${i}/${w}`;g.endsWith("/")||!g.includes(".",g.lastIndexOf("/"))&&w!==""?(g.endsWith("/")||(g+="/"),g+="index.html"):w===""&&(g=`/app/${i}/index.html`),console.log(`Mapping ${t} to VFS path: ${g}`);const S=await(await self.tonk.getVfs()).readFile(g);return console.log(S),S?J(S):new Response(`App path "${t}" (mapped to "${g}") not found. Make sure the app is properly loaded.`,{status:404,headers:{"Content-Type":"text/plain"}})}if(o&&!t.startsWith("/app/")){const i=`/app/${o}${t}`;console.log(`Rewriting ${t} to ${i}`);const w=await(await self.tonk.getVfs()).readFile(i);if(console.log(w),w)return J(w)}const s=await caches.match(n.request);return s||fetch(n.request)})())});
